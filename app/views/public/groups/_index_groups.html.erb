<% groups.each do |group| %>

<!--有効なユーザーがオーナーのグループのみ表示-->
<% unless group.owner.is_deleted %>
  <div class="card mt-2 shadow-lg">
    <div class="card-body">
      <%= link_to(group_path(group.id), class:"text-dark") do %>
        <p class="card-text"><i class="fa-solid fa-flask-vial"></i><%= group.name %> : <%= group.users.where(users: { is_deleted: false }).count %>人</p>
      <% end %>

      <%= link_to(user_path(group.owner.id), class:"text-dark") do %>
        <p class="card-text"><i class="fa-solid fa-star"></i>オーナー : <%= group.owner.name %></p>
      <% end %>

    <hr>
    <div class="row px-2">
      <div class="col-2">
        <%= link_to group_path(group.id) do %>
          <%= image_tag group.get_group_profile_image, size: "50x50" %>
        <% end %>
      </div>
      <div class="col-6 text-range">
        <%= group.introduction %>
      </div>
      <div class="col-2">
        <% if group.owner_id == current_user.id %>
          <%= link_to '編集', edit_group_path(group), class: "btn btn-sm btn-outline-secondary" %>
        <% end %>
      </div>
      <div class="col-2 px-2">
        <% if group.owner_id == current_user.id %>
          <%= link_to '解散', group_path(group), method: :delete, data: { confirm: '本当に消しますか？' }, class: "btn btn-sm btn-outline-secondary" %>
        <% elsif group.users.include?(current_user) %>
          <%= link_to '退会', group_group_users_path(group), method: :delete, class: "btn btn-sm btn-outline-secondary" %>
        <% else %>
          <%= link_to '参加', group_group_users_path(group), method: :post, class: "btn btn-sm btn-outline-secondary" %>
        <% end %>
      </div>
      <div class="col-12 text-right">
        <p class="card-text">Since <i class="fa-regular fa-clock"></i><%= l group.created_at, format: :short %></p>
      </div>
    </div>
    </div>
  </div>
<% end %>

<% end %>